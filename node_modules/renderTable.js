var jaml = require('../js/jaml');

Jaml.register('tableheader', function(header){
	th(header.toString());
});

Jaml.register('tablerow', function(row){
	tr(Jaml.render('tablecell', row));
});

Jaml.register('tablecell', function(cell){
	td(cell.toString());
});

Jaml.register('table', function(input)	{
	table({border:1,cellpadding:1},
		tr(Jaml.render('tableheader', input.head)),
		Jaml.render('tablerow', input.rows)
	);
});

exports.getHeader = function(row) {
	var header = [];

	for (var key in row[0]){
		header[header.length] = key;
	}
	
	return header;
}

exports.getData = function(row){
	var data = [[]];
	var i,j;
	
	for (i = 0; i < row.length; i++){
		data[i] = [];
		for (j in row[i]){
			data[i][data[i].length] = row[i][j];
		}
	}

	return data;
}

exports.tableToHTML = function(row){
	if ((row == undefined) || (row.length <= 0)) { return ""; }
	return Jaml.render('table', {head:exports.getHeader(row), 
					rows: exports.getData(row)});
}
